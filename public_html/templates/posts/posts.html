<div>
    <div class="panel panel-default">
        <ul class="nav nav-list">
            <li ng-class="{ active: $state.includes('posts') }">
                <h4>All Posts</h4>
            </li>
            <li ng-if="user.isLoggedIn">
                <button class="btn btn-info" ng-click="trigger()">Create a Post</button>
                <div class="panel" ng-if="create.form">
                    <form novalidate name="PostForm" ng-submit="PostForm.$valid && post()">
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-header"></i></span>
                                        <input type="text" name="title" id="title" ng-model="data.title" placeholder="Title" class="form-control" autocomplete="off" required>                                        
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    <div class="input-group">
                                        <span class="input-group-addon"><i class="fa fa-at"></i></span>
                                        <input type="url" ng-model="data.url" class="form-control" placeholder="URL" autocomplete="off" required>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <auto-complete model="data.tags"></auto-complete>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-xs-12 col-sm-12 col-md-12">
                                <div class="form-group">
                                    <div class="input-group">
                                        <input class="btn btn-info" type="submit" value="Create"> 
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </li>
            <li class="nav-header">Top Posts</li>
            <li class="list-group-item" ng-repeat="post in filteredPosts">
                <div>
                    <div class="row-fluid">
                        <div class="col-sm-1 ">
                            <p style="margin-top: 1em">{{($index + 1) + position}}.</p>
                        </div>
                        <div class="col-sm-1 v-center">
                            <a href="#" ng-click="voteUp(post)"> <i class="fa fa-angle-up"></i></a> <br />
                            <small>{{post.votes}}votes</small> <br />
                            <a href="#" ng-click="voteDown(post)"> <i class="fa fa-angle-down"></i></a>
                        </div>  
                        <div class="col-sm-8">
                            <h4><a href={{post.url}}>{{post.title}}</a></h4>
                            <div>
                                <ul class="list-inline">
                                    <li ng-repeat="tag in post.tags">
                                        <span class="fa fa-tag"></span>
                                    {{tag.name}}
                                    </li>
                                </ul>
                            <div>
                            <em>{{ post.created_at | timeAgo}}</em> 
                            by <cite>{{post.author.username}}</cite> 

                        </div>
                        <div>
                            <a href ng-click="select(post)">
                                <span class="fa-stack fa-2x">
                                    <i class="fa fa-comment fa-stack-2x"></i>
                                    <strong class="fa-stack-1x fa-stack-text fa-inverse">
                                        {{post.comments.length}}
                                    </strong>
                                </span>
                            </a>
                        </div>
                    </div>
                    <div class="panel" ng-show="isSelected(post)">
                        <ul class="nav nav-list" ng-repeat="comment in post.comments">
                            <li class="list-group-item">
                                <strong><cite>{{comment.author.username}}</cite></strong> 
                                {{comment.updated_at | timeAgo }}
                                <p>{{comment.message}}</p>
                            </li>
                        </ul>
                        <form class="CommentForm" novalidate role="form" ng-if="user.isLoggedIn" ng-submit="CommentForm.$valid && comment()">
                               <label for="InputComment">Add a Comment</label>
                               <textarea ng-model="newComment" class="form-control" id="InputComment" rows="3" required></textarea>
                            <button type="submit" class="btn btn-default">Submit</button>
                        </form>
                    </div>
                </div>       
            </li>
            <pagination total-items="totalItems" items-per-page="itemsPerPage" 
                        ng-model="currentPage" ng-change="pageChanged()"></pagination>
        </ul>
        <hr>
    </div>
</div>


